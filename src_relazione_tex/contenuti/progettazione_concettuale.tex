\section{Progettazione concettuale}

\subsection{Analisi delle entità}

%Imbarcazione
\begin{center}
    \begin{tabularx}{\textwidth}{|l|l|l|X|}
        \hline
        \rowcolor{gray!30}
        \multicolumn{4}{|c|}{\textbf{Imbarcazione}}\\
        \hline
        Codice internazionale & VARCHAR & Identifica univocamente un'imbarcazione nel mondo & Chiave\\
        \hline
        Nome & VARCHAR & \multicolumn{2}{l|}{Il nome dell'imbarcazione} \\
        \hline
        QtPostiLetto & INTEGER & \multicolumn{2}{l|}{La quantità di posti letto dell'imbarcazione} \\
        \hline
        Nome del capitano & VARCHAR & \multicolumn{2}{l|}{Il nome del capitano} \\
        \hline
        Bandiera & VARCHAR & \multicolumn{2}{l|}{Nome dello stato di cui batte bandiera l'imbarcazione} \\
        \hline
        Dimensioni &  & \multicolumn{2}{l|}{Attributo composto: Pescaggio, Larghezza, LOA} \\
        \hline
        Pescaggio & DECIMAL & \multicolumn{2}{l|}{La misura del punto più in profondità dell'imbarcazione} \\
        \hline
        Larghezza & DECIMAL & \multicolumn{2}{l|}{La misura della larghezza al baglio massimo dell'imbarcazione} \\
        \hline
        LOA & DECIMAL & \multicolumn{2}{l|}{La misura della lunghezza fuoritutto dell'imbarcazione} \\
        \hline
    \end{tabularx}
\end{center}

%Molo
\begin{center}
    \begin{tabularx}{\textwidth}{|l|l|l|X|}
        \hline
        \rowcolor{gray!30}
        \multicolumn{4}{|c|}{\textbf{Molo}}\\

        \hline
        Numero molo & INTEGER & Identifica univocamente un molo & Chiave\\
        \hline
        Stato di occupazione & BOOLEAN &\multicolumn{2}{l|}{ Lo stato di occupazione del molo}\\
        \hline
        Dimensioni &  & \multicolumn{2}{l|}{Attributo composto: Profondità minima, Larghezza, Lunghezza} \\
        \hline
        Profondità minima & DECIMAL & \multicolumn{2}{l|}{La profondità misurata alla più bassa marea sizigiale} \\
        \hline
        Larghezza & DECIMAL & \multicolumn{2}{l|}{La misura della larghezza del molo} \\
        \hline
        Lunghezza & DECIMAL & \multicolumn{2}{l|}{La misura della lunghezza del molo} \\
        \hline
    \end{tabularx}
\end{center}

%servizio
\begin{center}
    \begin{tabularx}{\textwidth}{|l|l|l|X|}
        \hline
        \rowcolor{gray!30}
        \multicolumn{4}{|c|}{\textbf{Servizio}}\\
        \hline
        Nome & VARCHAR & Il nome del servizio & Chiave \\
        \hline
    \end{tabularx}
\end{center}


%Addetto
\begin{center}
    \begin{tabularx}{\textwidth}{|l|l|l|X|}
        \hline
        \rowcolor{gray!30}
        \multicolumn{4}{|c|}{\textbf{Addetto}}\\
        \hline
        DataInizioContratto & DATE & È la data in cui il contratto è iniziato & Chiave\\
        \hline
        DataFineContratto & DATE &\multicolumn{2}{l|}{ È la data in cui il contratto è finito o finirà.(nullo se il contratto è indeterminato)}\\
        \hline
    \end{tabularx}
\end{center}

%Cliente
\begin{center}
    \begin{tabularx}{\textwidth}{|l|l|X|}
        \hline
        \rowcolor{gray!30}
        \multicolumn{3}{|c|}{\textbf{Cliente}}\\
        \hline
        Cittadinanza & VARCHAR & Lo stato di cui il cliente è cittadino\\
        \hline
        Residenza & VARCHAR & La città in cui il cliente è residente \\
        \hline
    \end{tabularx}
\end{center}

%Cliente occasionale
\begin{center}
    \begin{tabularx}{\textwidth}{|l|l|X|}
        \hline
        \rowcolor{gray!30}
        \multicolumn{3}{|c|}{\textbf{Cliente occasionale}}\\
        \hline
        Quantità di soste & INTEGER & Il numero di soste che il cliente ha effettuato presso la struttura \\
        \hline
    \end{tabularx}
\end{center}

%Cliente abituale
\begin{center}
    \begin{tabularx}{\textwidth}{|l|l|X|}
        \hline
        \rowcolor{gray!30}
        \multicolumn{3}{|c|}{\textbf{Cliente abituale}}\\
        \hline
        Sconto personale & DECIMAL & Lo sconto percentuale applicato alle sue fatture \\
        \hline
    \end{tabularx}
\end{center}

%Persona
\begin{center}
    \begin{tabularx}{\textwidth}{|l|l|l|X|}
        \hline
        \rowcolor{gray!30}
        \multicolumn{4}{|c|}{\textbf{Persona}}\\
        \hline
        CF & VARCHAR & Identifica univocamente una persona & Chiave \\
        \hline
        Nome & VARCHAR & \multicolumn{2}{l|}{Il nome della persona} \\
        \hline
        Cognome & VARCHAR & \multicolumn{2}{l|}{Il cognome della persona} \\
        \hline
        DataNascita & DATE & \multicolumn{2}{l|}{La data di nascita della persona} \\
        \hline
        Contatto & VARCHAR & \multicolumn{2}{l|}{I contatti della persona(multi-valore)} \\
        \hline
    \end{tabularx}
\end{center}

%Prenotazione
\begin{center}
    \begin{tabularx}{\textwidth}{|l|l|X|}
        \hline
        \rowcolor{gray!30}
        \multicolumn{3}{|c|}{\textbf{Prenotazione}}\\
        \hline
        Previsione arrivo & DATE & La data in cui si prevede il cliente arrivi\\
        \hline
        Previsione partenza & DATE & La data in cui si prevede il cliente parta\\
        \hline
        Stato di arrivo & BOOLEAN & Rappresenta se il cliente ha trasformato oppure no la prenotazione in sosta\\
        \hline
    \end{tabularx}
\end{center}

%Sosta
\begin{center}
    \begin{tabularx}{\textwidth}{|l|l|l|X|}
        \hline
        \rowcolor{gray!30}
        \multicolumn{4}{|c|}{\textbf{Sosta}}\\
        \hline
        Data arrivo & TIMESTAMP & Data in cui l'imbarcazione ha ormeggiato & Chiave \\
        \hline
        Data arrivo & TIMESTAMP & \multicolumn{2}{l|}{Data in cui l'imbarcazione ha sciolto gli ormeggi} \\
        \hline
    \end{tabularx}
\end{center}

%Allacciamento
\begin{center}
    \begin{tabularx}{\textwidth}{|l|l|l|X|}
        \hline
        \rowcolor{gray!30}
        \multicolumn{4}{|c|}{\textbf{Allacciamento}}\\
        \hline
        Nome & VARCHAR & Il nome che identifica la tipologia di allacciamento &Chiave\\
        \hline
        Prezzo unitario & DECIMAL & Il prezzo unitario dell'allacciamento\\
        \hline
        Unità di misura & VARCHAR & L'unità di misura utilizzata per conteggiarne il consumo\\
        \hline
    \end{tabularx}
\end{center}

%Oraro di apertura
\begin{center}
    \begin{tabularx}{\textwidth}{|l|l|l|X|}
        \hline
        \rowcolor{gray!30}
        \multicolumn{4}{|c|}{\textbf{Oraro di apertura}}\\
        \hline
        Giorno di apertura & CHAR(3) & Giorno a cui si riferisce l'orario di apertura & Chiave \\
        \hline
        Orario di apertura & TIME & Orario a cui il servizio apre nel giorno & Chiave \\
        \hline
        Orario di chiusura & TIME & Orario a cui il servizio cudehi nel giorno & Chiave \\
        \hline
    \end{tabularx}
\end{center}

%Consumo
\begin{center}
    \begin{tabularx}{\textwidth}{|l|l|l|X|}
        \hline
        \rowcolor{gray!30}
        \multicolumn{4}{|c|}{\textbf{Consumo}}\\
        \hline
        Data inizio lettura & TIMESTAMP & Momento dell'inizio del conteggio & Chiave \\
        \hline
        Data fine lettura & TIMESTAMP & \multicolumn{2}{l|}{Momento della fine del conteggio}\\
        \hline
        Quantità consumata & DECIMAL & \multicolumn{2}{l|}{La quantità consumata nel periodo} \\
        \hline
    \end{tabularx}
\end{center}

%Fattura
\begin{center}
    \begin{tabularx}{\textwidth}{|l|l|l|X|}
        \hline
        \rowcolor{gray!30}
        \multicolumn{4}{|c|}{\textbf{Fattura}}\\
        \hline
        Data scadenza & TIMESTAMP & Identifica la scadenza della fattura & Chiave \\
        \hline
        Pagato & TIMESTAMP & \multicolumn{2}{l|}{Identifica quando è stata pagata e lo stato del pagamento della fattura} \\
        \hline
    \end{tabularx}
\end{center}



\subsection{Generalizzazioni}

\begin{itemize}
    \item Persona è generalizzazione totale sovrapposta di Addetto e Cliente;
    \item Cliente è generalizzazione totale esclusiva di cliente abituale e cliente occasionale;
\end{itemize}

\subsection{Analisi delle relazioni e delle cardinalità}

\begin{itemize}
    \item corso - imbarcazione: \textbf{Uso}
    \begin{itemize}
        \item Un corso usa più imbarcazioni (0,N)
        \item Un'imbarcazione può essere usata in più corsi (0,N)
    \end{itemize}
    
    \item Marina - corso: \textbf{Organizzazione}
    \begin{itemize}
        \item Un marina può organizzare più corsi (0,N)
        \item Un corso può essere organizzato da un solo marina (1,1)
    \end{itemize}
    
    \item Molo - Marina: \textbf{Appartenenza}
    \begin{itemize}
        \item Un molo può appartenere ad un solo marina (1,1)
        \item Ad un marina possono appartenere molti molti (0,N)
    \end{itemize}
    
    \item Imbarcazione - Molo: \textbf{Sosta}
    \begin{itemize}
        \item Un imbarcazione può essere presente in più moli(0,N)
        \item Un molo può permettere la sosta di più imbarcazioni(0,N)
    \end{itemize}
\end{itemize}

%Da controllare come questione.
La relazione possiede gli attributi: data arrivo e data partenza per indicare univocamente una sosta. Infatti un'imbarcazione può essere presente in più moli solo in tempi differenti. Ci interessa infatti lo storico delle soste per fini statistici.

\begin{itemize}
    
    \item Marina - Servizio: \textbf{Offerta}
    \begin{itemize}
        \item Un marina offre da zero a più servizi(0,N);
        \item Un servizio è offerto da uno e un solo marina (1,1);
    \end{itemize}
    
    \item Molo - Allacciamento: \textbf{Possessione}
    \begin{itemize}
        \item Un Molo possiede più allacciamenti o nessuno (0,N);
        \item Un allacciamento può essere posseduto da più moli o da nessuno(0,N);
    \end{itemize}
    
    \item Prenotazione - Molo: \textbf{Riserva}
    \begin{itemize}
        \item Una prenotazione Riserva uno e un solo molo (1,1);
        \item Un molo può essere riservato da più prenotazioni o da nessuna (0,N);
    \end{itemize}
    
    \item Cliente - Imbarcazione: \textbf{Possiede}
    \begin{itemize}
        \item Un cliente può possedere più imbarcazioni(Almeno una) (1,N);
        \item Un imbarcazione è posseduta da una e una sola una persona(1,1);
    \end{itemize}
    
    \item Cliente - Prenotazione: \textbf{Effettua}
    \begin{itemize}
        \item Un cliente può effettuare da 1 a molte prenotazioni(1,N);
        \item Una prenotazione può essere effettuata al massimo da un cliente (1,1);
    \end{itemize}
    
    \item Addetto - Servizio: \textbf{Gestione}
    \begin{itemize}
        \item Un addetto gestisce uno e un solo servizio (1,1);
        \item Un servizio è gestito da uno e un solo addetto (1,1);
    \end{itemize}
    
    \item Marina - Consumo - Fattura: \textbf{Emissione}
    \begin{itemize}
        \item Un marina può emettere molte fatture relative a molti consumi (0,N);
        \item Un Consumo può essere inserito solo nell'emissione di una fattura da un marina (1,1);
        \item Una fattura può essere relativa solo ad un marina e ad un consumo (1,1);
    \end{itemize}
    
    \item Consumo - Allacciamento: \textbf{Utilizzo}
    \begin{itemize}
        \item Un consumo utilizza uno e un solo allacciamento(1,1);
        \item Un allacciamento può essere utilizzato da 0 a molte fatture(0,N);
    \end{itemize}
    
%Come gestisco le fatture già pagate?
    \item Cliente - Fattura: \textbf{Deve pagare}
    \begin{itemize}
        \item Un cliente deve pagare da 0 a molte fatture (0,N);
        \item Una fattura deve essere pagata solo da un cliente (1,1);
    \end{itemize}
    
    \item Cliente - Consumo: \textbf{Generazione}
    \begin{itemize}
        \item Un cliente può generare molteplici consumi (0,N);
        \item Un consumo può essere generato da un solo cliente (1,1);
    \end{itemize}
    
\end{itemize}

\subsection{Schema ER concettuale}
\includegraphics[width=\textwidth]{img/erconcettuale.png}